<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:ProgressCircleGradient.Controls.ProgressCircle">

    <ResourceDictionary.ThemeDictionaries>
        <ResourceDictionary x:Key="Light">
            <SolidColorBrush x:Key="OneUIProgressCircleDeterminateTextForeground" Color="#010102" />
            <SolidColorBrush x:Key="OneUIProgressCircleIndeterminateEllipse" Color="#387AFF" />
            <SolidColorBrush x:Key="OneUIProgressCircleIndeterminateVariantEllipse" Color="#3DCC87" />
        </ResourceDictionary>

        <ResourceDictionary x:Key="Dark">
            <SolidColorBrush x:Key="OneUIProgressCircleDeterminateTextForeground" Color="#010102" />
            <SolidColorBrush x:Key="OneUIProgressCircleIndeterminateEllipse" Color="#387AFF" />
            <SolidColorBrush x:Key="OneUIProgressCircleIndeterminateVariantEllipse" Color="#3DCC87" />
        </ResourceDictionary>

        <ResourceDictionary x:Key="HighContrast">
            <SolidColorBrush x:Key="OneUIProgressCircleDeterminateTextForeground" Color="#010102" />
            <SolidColorBrush x:Key="OneUIProgressCircleIndeterminateEllipse" Color="#387AFF" />
            <SolidColorBrush x:Key="OneUIProgressCircleIndeterminateVariantEllipse" Color="#3DCC87" />
        </ResourceDictionary>
    </ResourceDictionary.ThemeDictionaries>

    <Style BasedOn="{StaticResource OneUIProgressCircleIndeterminate}" TargetType="local:ProgressCircleIndeterminate" />

    <Style x:Key="OneUIProgressCircleIndeterminate" TargetType="local:ProgressCircleIndeterminate">
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:ProgressCircleIndeterminate">
                    <Grid x:Name="PART_RootMainGrid">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <!--  Component  -->
                        <Grid
                            x:Name="PART_RootGrid"
                            Grid.Row="0"
                            Grid.Column="0"
                            RenderTransformOrigin="0.5,0.5">
                            <Grid.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform x:Name="GS" ScaleX="1" ScaleY="1" />
                                    <RotateTransform x:Name="GR" Angle="0" />
                                </TransformGroup>
                            </Grid.RenderTransform>

                            <!--  Dots: all start at center, positioned by TranslateTransform  -->
                            <Grid
                                x:Name="PART_ColorGrid"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                                <!--  Dot 1 (Top)  -->
                                <Ellipse
                                    x:Name="PART_Ellipse01"
                                    Width="{TemplateBinding EllipseDiameter}"
                                    Height="{TemplateBinding EllipseDiameter}"
                                    Margin="0,0,0,3"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Fill="{ThemeResource OneUIProgressCircleIndeterminateEllipse}"
                                    Opacity="1">
                                    <Ellipse.RenderTransform>
                                        <TranslateTransform x:Name="EllipseTranslate1" X="0" Y="{TemplateBinding EllipseNegativeDisplacement}" />
                                    </Ellipse.RenderTransform>
                                </Ellipse>

                                <!--  Dot 2 (Right) - variant  -->
                                <Ellipse
                                    x:Name="PART_EllipsePoint"
                                    Width="{TemplateBinding EllipseDiameter}"
                                    Height="{TemplateBinding EllipseDiameter}"
                                    Margin="3,0,0,0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Fill="{ThemeResource OneUIProgressCircleIndeterminateVariantEllipse}"
                                    Opacity="1">
                                    <Ellipse.RenderTransform>
                                        <TranslateTransform x:Name="EllipseTranslate2" X="{TemplateBinding EllipseMaxOffset}" Y="0" />
                                    </Ellipse.RenderTransform>
                                </Ellipse>

                                <!--  Dot 3 (Bottom)  -->
                                <Ellipse
                                    x:Name="PART_Ellipse02"
                                    Width="{TemplateBinding EllipseDiameter}"
                                    Height="{TemplateBinding EllipseDiameter}"
                                    Margin="0,3,0,0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Fill="{ThemeResource OneUIProgressCircleIndeterminateEllipse}"
                                    Opacity="1">
                                    <Ellipse.RenderTransform>
                                        <TranslateTransform x:Name="EllipseTranslate3" X="0" Y="{TemplateBinding EllipseMaxOffset}" />
                                    </Ellipse.RenderTransform>
                                </Ellipse>

                                <!--  Dot 4 (Left)  -->
                                <Ellipse
                                    x:Name="PART_Ellipse03"
                                    Width="{TemplateBinding EllipseDiameter}"
                                    Height="{TemplateBinding EllipseDiameter}"
                                    Margin="0,0,3,0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Fill="{ThemeResource OneUIProgressCircleIndeterminateEllipse}"
                                    Opacity="1">
                                    <Ellipse.RenderTransform>
                                        <TranslateTransform x:Name="EllipseTranslate4" X="{TemplateBinding EllipseNegativeDisplacement}" Y="0" />
                                    </Ellipse.RenderTransform>
                                </Ellipse>
                            </Grid>

                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal">
                                        <!--
                                            Dot/Scale total: 2000ms (Delay 200ms at end)
                                            Phase 1: 0 -> 650ms    (20dp -> 9dp)    [0.5,0,0.83,0.57]
                                            Phase 2: 650 -> 1100ms (11dp -> 0dp)    [0.34,0.83,0.61,1] + opacity down to 45/70/55/70
                                            Phase 3: 1100 -> 1800ms (0dp -> 20dp)   [0.12,0.13,0.31,1]
                                            Delay: 1800 -> 2000ms hold
                                            Rotation: 2000ms loop linear
                                        -->
                                        <Storyboard x:Name="RotateAnimation">

                                            <!--  Rotation: 0->360 in 2000ms, repeat immediately  -->
                                            <DoubleAnimationUsingKeyFrames
                                                BeginTime="0"
                                                RepeatBehavior="Forever"
                                                Storyboard.TargetName="GR"
                                                Storyboard.TargetProperty="Angle">
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0"
                                                    Value="0" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:1"
                                                    Value="360" />
                                            </DoubleAnimationUsingKeyFrames>

                                            <!--  Component scale X  -->
                                            <DoubleAnimationUsingKeyFrames
                                                BeginTime="0"
                                                EnableDependentAnimation="True"
                                                RepeatBehavior="Forever"
                                                Storyboard.TargetName="GS"
                                                Storyboard.TargetProperty="ScaleX">
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0.65"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.5,0,0.76,1"
                                                    KeyTime="0:0:1.1"
                                                    Value="2" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.09,0,0,1"
                                                    KeyTime="0:0:1.8"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:2.0"
                                                    Value="1" />
                                            </DoubleAnimationUsingKeyFrames>

                                            <!--  Component scale Y  -->
                                            <DoubleAnimationUsingKeyFrames
                                                BeginTime="0"
                                                EnableDependentAnimation="True"
                                                RepeatBehavior="Forever"
                                                Storyboard.TargetName="GS"
                                                Storyboard.TargetProperty="ScaleY">
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0.65"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.5,0,0.76,1"
                                                    KeyTime="0:0:1.1"
                                                    Value="2" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.09,0,0,1"
                                                    KeyTime="0:0:1.8"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:2.0"
                                                    Value="1" />
                                            </DoubleAnimationUsingKeyFrames>

                                            <!--  Dot 1 (Top) Y: -20 -> -9 -> 0 -> -20  -->
                                            <DoubleAnimationUsingKeyFrames
                                                BeginTime="0"
                                                EnableDependentAnimation="True"
                                                RepeatBehavior="Forever"
                                                Storyboard.TargetName="EllipseTranslate1"
                                                Storyboard.TargetProperty="Y">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{Binding EllipseNegativeDisplacement, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.5,0,0.83,0.57"
                                                    KeyTime="0:0:0.65"
                                                    Value="{Binding EllipseNegativeMinOffset, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.1"
                                                    Value="0" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.12,0.13,0.31,1"
                                                    KeyTime="0:0:1.8"
                                                    Value="{Binding EllipseNegativeDisplacement, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:2.0" Value="{Binding EllipseNegativeDisplacement, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                            </DoubleAnimationUsingKeyFrames>

                                            <!--  Dot 2 (Right) X: +20 -> +9 -> 0 -> +20  -->
                                            <DoubleAnimationUsingKeyFrames
                                                BeginTime="0"
                                                EnableDependentAnimation="True"
                                                RepeatBehavior="Forever"
                                                Storyboard.TargetName="EllipseTranslate2"
                                                Storyboard.TargetProperty="X">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{Binding EllipseMaxOffset, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.5,0,0.83,0.57"
                                                    KeyTime="0:0:0.65"
                                                    Value="{Binding EllipseMinOffset, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.1"
                                                    Value="0" />
                                                <!--  Phase 3 update: [0.12,0.13,0.31,1]  -->
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.12,0.13,0.31,1"
                                                    KeyTime="0:0:1.8"
                                                    Value="{Binding EllipseMaxOffset, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:2.0" Value="{Binding EllipseMaxOffset, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                            </DoubleAnimationUsingKeyFrames>

                                            <!--  Dot 3 (Bottom) Y: +20 -> +9 -> 0 -> +20  -->
                                            <DoubleAnimationUsingKeyFrames
                                                BeginTime="0"
                                                EnableDependentAnimation="True"
                                                RepeatBehavior="Forever"
                                                Storyboard.TargetName="EllipseTranslate3"
                                                Storyboard.TargetProperty="Y">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{Binding EllipseMaxOffset, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.5,0,0.83,0.57"
                                                    KeyTime="0:0:0.65"
                                                    Value="{Binding EllipseMinOffset, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.1"
                                                    Value="0" />
                                                <!--  Phase 3 update: [0.12,0.13,0.31,1]  -->
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.12,0.13,0.31,1"
                                                    KeyTime="0:0:1.8"
                                                    Value="{Binding EllipseMaxOffset, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:2.0" Value="{Binding EllipseMaxOffset, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                            </DoubleAnimationUsingKeyFrames>

                                            <!--  Dot 4 (Left) X: -20 -> -9 -> 0 -> -20  -->
                                            <DoubleAnimationUsingKeyFrames
                                                BeginTime="0"
                                                EnableDependentAnimation="True"
                                                RepeatBehavior="Forever"
                                                Storyboard.TargetName="EllipseTranslate4"
                                                Storyboard.TargetProperty="X">
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{Binding EllipseNegativeDisplacement, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.5,0,0.83,0.57"
                                                    KeyTime="0:0:0.65"
                                                    Value="{Binding EllipseNegativeMinOffset, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.1"
                                                    Value="0" />
                                                <!--  Phase 3 update: [0.12,0.13,0.31,1]  -->
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.12,0.13,0.31,1"
                                                    KeyTime="0:0:1.8"
                                                    Value="{Binding EllipseNegativeDisplacement, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                                <DiscreteDoubleKeyFrame KeyTime="0:0:2.0" Value="{Binding EllipseNegativeDisplacement, RelativeSource={RelativeSource Mode=TemplatedParent}}" />
                                            </DoubleAnimationUsingKeyFrames>

                                            <!--  Opacity (spec): at 1100ms (0dp) => 45/70/55/70  -->
                                            <DoubleAnimationUsingKeyFrames
                                                BeginTime="0"
                                                RepeatBehavior="Forever"
                                                Storyboard.TargetName="PART_Ellipse01"
                                                Storyboard.TargetProperty="Opacity">
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0.65"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.1"
                                                    Value="0.45" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.8"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:2.0"
                                                    Value="1" />
                                            </DoubleAnimationUsingKeyFrames>

                                            <DoubleAnimationUsingKeyFrames
                                                BeginTime="0"
                                                RepeatBehavior="Forever"
                                                Storyboard.TargetName="PART_EllipsePoint"
                                                Storyboard.TargetProperty="Opacity">
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0.65"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.1"
                                                    Value="0.7" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.8"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:2.0"
                                                    Value="1" />
                                            </DoubleAnimationUsingKeyFrames>

                                            <DoubleAnimationUsingKeyFrames
                                                BeginTime="0"
                                                RepeatBehavior="Forever"
                                                Storyboard.TargetName="PART_Ellipse02"
                                                Storyboard.TargetProperty="Opacity">
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0.65"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.1"
                                                    Value="0.55" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.8"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:2.0"
                                                    Value="1" />
                                            </DoubleAnimationUsingKeyFrames>

                                            <DoubleAnimationUsingKeyFrames
                                                BeginTime="0"
                                                RepeatBehavior="Forever"
                                                Storyboard.TargetName="PART_Ellipse03"
                                                Storyboard.TargetProperty="Opacity">
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:0.65"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.1"
                                                    Value="0.7" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0.34,0.83,0.61,1"
                                                    KeyTime="0:0:1.8"
                                                    Value="1" />
                                                <SplineDoubleKeyFrame
                                                    KeySpline="0,0,1,1"
                                                    KeyTime="0:0:2.0"
                                                    Value="1" />
                                            </DoubleAnimationUsingKeyFrames>

                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </Grid>

                        <TextBlock
                            x:Name="PART_text"
                            Grid.Row="1"
                            Grid.Column="0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontSize="13"
                            FontWeight="Normal"
                            Foreground="{ThemeResource OneUIProgressCircleDeterminateTextForeground}"
                            HorizontalTextAlignment="Center"
                            MaxLines="2"
                            Text="{TemplateBinding Text}"
                            TextAlignment="Center"
                            TextTrimming="CharacterEllipsis"
                            TextWrapping="Wrap"
                            Visibility="Collapsed" />

                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CustomStates">
                                <VisualState x:Name="TextVerticalAlignment">
                                    <VisualState.Setters>
                                        <Setter Target="PART_RootGrid.(Grid.Row)" Value="0" />
                                        <Setter Target="PART_RootGrid.(Grid.Column)" Value="0" />
                                        <Setter Target="PART_text.(Grid.Row)" Value="1" />
                                        <Setter Target="PART_text.(Grid.Column)" Value="0" />
                                        <Setter Target="PART_RootGrid.Margin" Value="4" />
                                        <Setter Target="PART_text.Margin" Value="0,0,0,4" />
                                    </VisualState.Setters>
                                </VisualState>
                                <VisualState x:Name="TextHorizontalAlignment">
                                    <VisualState.Setters>
                                        <Setter Target="PART_RootGrid.(Grid.Row)" Value="1" />
                                        <Setter Target="PART_RootGrid.(Grid.Column)" Value="0" />
                                        <Setter Target="PART_text.(Grid.Row)" Value="1" />
                                        <Setter Target="PART_text.(Grid.Column)" Value="1" />
                                        <Setter Target="PART_RootGrid.Margin" Value="4,4,4,4" />
                                        <Setter Target="PART_text.Margin" Value="4,0,4,0" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
